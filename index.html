<!doctype html>
<head>
	<title>interactive svg + canvas plot</title>
	<style>
		body { margin: 0; }
		rect { fill: transparent; }
	</style>
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script src="js/MultiSegmentScale.js"></script>
	<script src="js/Dot.js"></script>
</head>
<body>
	<script type='text/javascript'>




var data_string = "ref_start,ref_end,query_start,query_end,ref_length,query_length,ref,query,tag,alignment_length\n4511,383496,749,379657,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n385007,437149,380310,432421,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n437519,449529,432416,444426,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n449530,538501,447433,536405,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n527471,645501,529260,647285,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n651420,668296,647281,664155,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n668292,680705,670074,682487,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n681540,1095479,684107,1098051,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n1095474,1206704,1103482,1214716,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n1212622,1308422,1214711,1310510,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n1307789,1525466,1309709,1527391,1531933,1548464,ref|NC_001136|,JSAC01000026.1,unique,1188002\n21180,1091291,21173,1091266,1091291,1091404,ref|NC_001147|,JSAC01000002.1,unique,1070118\n6987,18843,510,12366,85779,45423,ref|NC_001224|,JSAC01000016.1,unique,915674\n18841,29295,12399,22855,85779,45423,ref|NC_001224|,JSAC01000016.1,unique,915674\n29552,30124,24691,25263,85779,45423,ref|NC_001224|,JSAC01000016.1,unique,915674\n30305,34448,25665,29809,85779,45423,ref|NC_001224|,JSAC01000016.1,unique,915674\n35227,50168,30529,45423,85779,45423,ref|NC_001224|,JSAC01000016.1,unique,915674\n56289,67800,1081,12504,85779,12504,ref|NC_001224|,JSAC01000019.1,unique,915674\n72518,80511,1,7991,85779,7991,ref|NC_001224|,JSAC01000020.1,unique,915674\n657018,1071649,188197,602789,1078177,609583,ref|NC_001144|,JSAC01000036.1,unique,883452\n481898,593144,19525,130772,1078177,609583,ref|NC_001144|,JSAC01000036.1,unique,573619\n212266,562524,8204,358458,562643,358555,ref|NC_001140|,JSAC01000027.1,unique,554320\n8781,530056,4150,525404,1090940,1090383,ref|NC_001139|,JSAC01000001.1,unique,525906\n599063,650823,130768,182564,1078177,609583,ref|NC_001144|,JSAC01000036.1,unique,520055\n6619,96609,6975,96986,784333,777478,ref|NC_001146|,JSAC01000005.1,unique,408222\n102559,730299,103047,730750,784333,777478,ref|NC_001146|,JSAC01000005.1,unique,408222\n710293,765398,710759,765858,784333,777478,ref|NC_001146|,JSAC01000005.1,unique,408222\n62,144915,1,144858,666816,678555,ref|NC_001143|,JSAC01000011.1,unique,401257\n144917,202915,144968,202994,666816,678555,ref|NC_001143|,JSAC01000011.1,unique,401257\n202911,379670,208919,385677,666816,678555,ref|NC_001143|,JSAC01000011.1,unique,401257\n379666,517455,386019,523754,666816,678555,ref|NC_001143|,JSAC01000011.1,unique,401257\n517785,578486,523747,584410,666816,678555,ref|NC_001143|,JSAC01000011.1,unique,401257\n578482,666754,590335,678555,666816,678555,ref|NC_001143|,JSAC01000011.1,unique,401257\n2,354657,226,354881,745751,751537,ref|NC_001142|,JSAC01000007.1,unique,354431\n367042,715319,372894,721163,745751,751537,ref|NC_001142|,JSAC01000007.1,unique,342425\n25352,320800,18410,313859,439888,429631,ref|NC_001141|,JSAC01000012.1,unique,302390\n823393,1090940,822624,1090197,1090940,1090383,ref|NC_001139|,JSAC01000001.1,unique,268316\n168673,457515,199924,488767,1078177,488768,ref|NC_001144|,JSAC01000038.1,unique,257591\n1,457629,165,457528,576874,457528,ref|NC_001137|,JSAC01000021.1,unique,232942\n443549,464156,1,20592,576874,20592,ref|NC_001137|,JSAC01000022.1,unique,232942\n449622,576874,1,127230,576874,127552,ref|NC_001137|,JSAC01000025.1,unique,232942\n212897,216251,0,3356,562643,14132,ref|NC_001140|,JSAC01000028.1,unique,216251\n477105,477671,679325,678759,813184,1090383,ref|NC_001134|,JSAC01000001.1,unique,201654\n529925,682356,525363,677790,1090940,1090383,ref|NC_001139|,JSAC01000001.1,unique,156993\n8096,97045,2697,91635,924431,932757,ref|NC_001145|,JSAC01000004.1,unique,154497\n76964,190083,71566,184674,924431,932757,ref|NC_001145|,JSAC01000004.1,unique,154497\n202186,748223,202509,748491,924431,932757,ref|NC_001145|,JSAC01000004.1,unique,154497\n748219,908217,754416,914406,924431,932757,ref|NC_001145|,JSAC01000004.1,unique,154497\n908132,917160,915437,924475,924431,932757,ref|NC_001145|,JSAC01000004.1,unique,154497\n1,258789,160,258926,813184,818518,ref|NC_001134|,JSAC01000006.1,unique,147791";

/* SET UP ENV */

var _map = {	width: 960,
				height: 500,
				x: 'ref',
				y: 'query'
			};

var _plotting_area = 
	d3.select('body')
		.append('div')
		.attr("id","plotting-area");

/* PREPARE DATA and SCALES */
var _data = null;

var _scales = {x: null, y: null};

var _settings = {	padding_fraction: 0.01	};


var _dot;
/* PLOT */

function get_data() {

	const numericColumns = ["ref_length", "ref_start", "ref_end", "query_length", "query_start", "query_end", "alignment_length"];
	_data = d3.csvParse(data_string, function(d) {
		// type the following columns as numbers
		numericColumns.map( key => d[key] = Number(d[key]) );
		return d;
	});

	_dot = new Dot(_plotting_area, {data: _data, height: _map.height, width: _map.width});
	_dot.draw();
}

get_data();



// /////////////////////////////////////////  Loading test files   /////////////////////////////////////////////
// function read_file(filename) {

//   d3.csv(filename, function(error,coords_input) {
//       if (error) throw error;
			
//       for (var i=0;i<coords_input.length;i++){
//         coords_input[i].ref_start = +coords_input[i].ref_start
//         coords_input[i].query_start = +coords_input[i].query_start
//         coords_input[i].ref_end = +coords_input[i].ref_end
//         coords_input[i].query_end = +coords_input[i].query_end
//         coords_input[i].ref_length = +coords_input[i].ref_length
//         coords_input[i].query_length = +coords_input[i].query_length
//       }
//       _data = coords_input; // set global variable for accessing this elsewhere
//       loaded_alignments = true;

//       draw_alignments();

//       console.log(_data);
//       console.log("Done loading data from file");
//   });
// }
// /////////////////////////////////////////  END Loading test files   //////////////////////////////////////////
// read_file("test_files/Saccharomyces_cerevisiae_MHAP_assembly.oriented_coords.csv");


	</script>
</body>


